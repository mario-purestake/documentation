# Индексаторы

## Кто такой индексатор?

Индексатор - это участник сети SubQuery, который отвечает за индексирование данных блокчейна и предоставление этих данных своим клиентам.

Индексаторы играют очень важную роль в сети SubQuery. Являясь частью бизнеса по предоставлению данных как услуги, индексатор превращает вычислительные и сетевые мощности в прибыль.

## Ставка индексатора

Для того чтобы получать вознаграждение от доходов от запросов в качестве индексатора, предлагается, что индексаторы должны делать ставки SQT против определенного проекта SubQuery, которому они предоставляют услуги. Производственная функция Кобба-Дугласа будет использоваться для определения вознаграждения, распределяемого каждому индексатору.

SubQuery планирует добавить в сеть ограничение, при котором индексатор должен поставить минимальное количество SQT на соответствующий пул вознаграждений, чтобы иметь возможность участвовать в соответствующем открытом соглашении. Они также должны сделать ставку на минимальную сумму по эквивалентному контракту на ставку для любых Закрытых соглашений таким же образом. Минимальная ставка индексатора должна составлять определенный процент от суммы вознаграждения по Соглашению за Era, что означает, что для продления Соглашения на более высокие объемы индексатор также должен увеличить свою ставку. Если доля индексатора уменьшится ниже этой минимальной суммы, он не сможет продлить Соглашение по существующей цене.

Если индексатора поймают на неправильном поведении (например, на предоставлении недействительных, неполных или неверных данных), он будет обязан перераспределить часть своих SQT (на конкретный пул вознаграждения ip) в казну фонда SubQuery, что уменьшит его долю SQT в сети и, следовательно, его потенциальное вознаграждение. Поскольку выделенная доля индексатора определяется процентом от его общего SQT, это окажет влияние на все остальные пулы вознаграждений, в которых участвует индексатор.

## Как вознаграждаются индексаторы?

Индексаторы вознаграждаются в SQT двумя способами:
- Вознаграждения из пулов вознаграждений SQT на основе распределения, определяемого производственной функцией Кобба-Дугласа.
- Прямые вознаграждения за запросы SQT из Закрытых соглашений, в которых участвует индексатор.

Индексаторы получают вознаграждение, которое платят потребители за предоставление данных блокчейна, которые запросил потребитель. Индексатор будет получать все вознаграждения от Закрытого соглашения. В противном случае плата распределяется в зависимости от объема выполненной работы (обслуженных заявок) и объема делегированного SQT - это распределение определяется путем применения производственной функции Кобба-Дугласа.

Для данного индексатора могут быть одновременно активны несколько пулов вознаграждений. Работа индексатора заключается в распределении своего SQT между этими пулами (в процентном соотношении от их общего SQT). Будет создан пул вознаграждений для каждого проекта, который Индексатор принимает PAYG, и пул вознаграждений для каждого рыночного соглашения, стороной которого является Индексатор.

## Привлечение делегаторов

Индексаторы могут увеличить свой потенциал заработка, привлекая Делегаторов. Делегаторы - это держатели токенов SQT, которые могут делегировать свои токены индексаторам для получения дополнительного вознаграждения. Индексаторы используют эти дополнительные токены для увеличения суммы, которую они выделяют на проекты по своему выбору. Это позволяет индексаторам увеличить свои доходы.

Индексаторы устанавливают ставку комиссии индексатора (ICR), которая представляет собой процент, зарабатываемый индексаторами. Оставшаяся сумма распределяется между индексатором и всеми делегаторами пропорционально размеру ставки/делегированной суммы. Поэтому Индексаторам необходимо решить, какую долю прибыли Индексатор хочет оставить себе, а какую разделить со своими Делегаторами. Более низкий ICR будет более привлекательным для делегаторов.

Например, индексатор А установил ICR 80% и получил SQT от 8 делегаторов. Это означает, что 8 делегаторов плюс сам Индексатор получат вознаграждение в размере оставшихся 20% от заработанного Индексатором. Доля будет разделена между ними пропорционально. Обратите внимание, что делегаторы должны делегировать свои токены в течение всей Era, чтобы иметь право на получение этих вознаграждений. Для получения дополнительной информации о вознаграждениях делегаторов см. раздел [Делегаторы](./delegators.md).

## Становление индексатором

Чтобы стать индексатором в сети SubQuery, индексатор должен обладать необходимым оборудованием, запускать необходимые службы SubQuery, иметь общедоступную сеть через статический IP или доменное имя и зарегистрироваться в качестве индексатора.

### Набор навыков индексатора

В целом, индексатор должен быть технически грамотным пользователем компьютера. Однако простота сети SubQuery и предлагаемых фреймворков позволяет даже начинающему разработчику успешно участвовать в проекте.

A basic user should be familiar with provisioning and managing servers, installing the SubQuery CLI tools, database management, and basic networking. More experienced users may run nodes in a clustered environment, incorporate monitoring and alerts and also more advanced networking management.

Finally, interested parties should be prepared to invest time in maintaining their indexing nodes and infrastructure.

### Staking requirements

Ожидается что индексаторы будут стейкать и поддерживать минимальное количество токенов. Это необходимо для того, чтобы обеспечить вовлеченность и заинтересованность индексаторов в поддержании сети. SubQuery все еще определяет это, но одна из наших позиций дизайна это то, чтобы он был как можно низкопороговым и доступным.

Если индексатор столкнется со случаем штрафа и баланс его монет SQT снизится ниже минимально требуемого, ему будет необходимо пополнить свой баланс застейканных SQT, чтобы продолжать получать вознаграждение за свою работу.

### Требования по оборудованию

Индексаторы могут инвестировать в собственное инфраструктурное оборудование или арендовать инфраструктуру у таких компаний, как AWS, Google Cloud, Digital Ocean, Microsoft Azure и др.

### Maintenance/operational requirements

Вот некоторые требования к техническому обслуживанию и/или эксплуатации, которые будут ожидать индексаторов:

- Всегда обновляйте программное обеспечение Subquery до последней версии.
- Определяйте и пользуйтесь новыми возможностями индексации.
- Обновляйте версию проекта до последней и переиндексируйте проект при необходимости.
- Техническое обслуживание инфраструктуры:
  - Постоянный мониторинг и увеличение объема диска.
  - Правильный размер запросов и индексации вычисляются на основе трафика.
  - Увеличьте количество запросов для увеличения входящего трафика.

### Инфраструктура

Минимальные требования к инфраструктуре включают в себя:

- Как минимум один вычислительный узел для запуска нижеуказанных сервисов:
  - Обслуживание (индексация) Узла.
  - Служба запросов.
  - Служба координации индексатора.
- Один узел базы данных для запуска Postgresql db (v12 и выше).

Более подробная информация появится в скором времени.

## Вопросы безопасности и производительности

Вопросы безопасности и производительности приведены ниже.

### Кошельки оператора

Настоятельно рекомендуется безопасное хранение исходной фразы восстановления кошелька индексатора.

### Firewalls/Файрволл

Индексаторы должны помнить о безопасности. Безопасность инфраструктуры, в частности файрволлы, должна быть реализована, чтобы предотвратить публичный доступ к личным портам.

По умолчанию должны использоваться надежные пароли и также нужно рассматривать политику ротации паролей.

### Производительность Индексатора

Для обеспечения желаемой производительности, индексаторы должны учитывать различные факторы, такие как:

- баланс между их собственной долей стейкинг монет и долей стейкинга Делегаторов.
- тип ослуживаемого контракта. Индексатор получит все вознаграждение за запрос, если это закрытый контракт. Если это открытый контракт, то вознаграждение индексатора будет зависеть от количества других индексаторов.
- выполнение условий Соглашения об уровне обслуживания (SLA) (чтобы избежать штрафных санкций).
- точность предоставляемых данных, чтобы избежать штрафов.

## Выбор Проектов Subquery для индексации

Существует несколько индикаторов, которые необходимо учитывать индексатору при выборе проекта SubQuery для индексации.

### Возможности Оплаты Запросов

Некоторые проекты будут иметь открытые или закрытые планы, рекламируемые потребителями.

Когда Потребитель рекламирует открытый или закрытый план для проекта, он в итоге указывает, сколько он готов платить за заданный объем запросов. Чем больше Потребитель готов заплатить, тем более привлекательным будет проект для Индексатора. Это также придает уверенность в том, что данный проект SubQuery, вероятней всего, будет приносить регулярный доход.

### Project complexity

Projects will vary in computation requirements. Simple projects will only index a few parameters whereas more complicated projects will require more computation resources and more bandwidth. Indexers need to understand the complexity of the project and its hardware capabilities.

### Indexer Competition

Popular projects offering a high query volume that attract a large number of Indexers. This also implies that the rewards will be shared amongst more people. A single Indexer’s share may be less than a less popular project with a slightly lower query fee but with far fewer Indexers.

### Ценовая политика

Indexers need to be aware of their operation cost and expected incomes to understand their break-even point. Некоторые вопросы по этому поводу:

- Как индексаторам следует устанавливать цены на свои планы?
- По какой цене индексаторы могут принять соглашение об обслуживании или нет?

### Advertisements

Indexers need to advertise themselves to Delegators as well as Consumers. Indexers may do this from their own website, in the Subquery forums or any other places deemed necessary. Some examples of the information to provide are:

- The background and experience of the Indexer or Indexer’s team.
- The hardware approach and why it provides superior performance.
- The customer support policy or SLA.
- Evidence of historical performances.

### Customer support

Indexers are highly encouraged to provide a communication method for its customers to report inavailability and also to provide feedback.
